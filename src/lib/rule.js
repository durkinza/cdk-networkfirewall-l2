"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.StatefulDomainListRule = exports.StatefulDomainListTargetType = exports.StatefulDomainListType = exports.Stateful5TupleRule = exports.StatefulRuleBase = exports.Stateful5TupleDirection = exports.StatelessRule = void 0;
const actions_1 = require("./actions");
const rules_common_1 = require("./private/rules-common");
/**
 * The base class of Stateless Rules
 */
class StatelessRuleBase {
}
/**
 * Defines a Network Firewall Stateless Rule
 */
class StatelessRule extends StatelessRuleBase {
    constructor(props) {
        super();
        // Adding Validations
        /**
         * Validating Actions
         */
        // Ensure only one standard action is provided.
        let standard_action_provided = false;
        let action;
        for (action of props.actions) {
            if (Object.values(actions_1.StatelessStandardAction).includes(action)) {
                if (standard_action_provided) {
                    throw new Error('Only one standard action can be provided, all other actions must be custom');
                }
                standard_action_provided = true;
            }
        }
        /**
         * Saving to object for furture capacity calculations.
         * Capacity can't be calculated yes since props can be updated
         */
        this.destinations = props.destinations || [];
        this.destinationPorts = props.destinationPorts || [];
        this.sources = props.sources || [];
        this.sourcePorts = props.sourcePorts || [];
        this.protocols = props.protocols || [];
        const destinations = (0, rules_common_1.castAddressProperty)(props.destinations);
        const sources = (0, rules_common_1.castAddressProperty)(props.sources);
        const ruleMatchAttributes = {
            destinationPorts: props.destinationPorts,
            destinations: destinations,
            sourcePorts: props.sourcePorts,
            sources: sources,
            protocols: props.protocols,
            tcpFlags: props.tcpFlags,
        };
        const ruleDefinition = {
            actions: props.actions,
            matchAttributes: ruleMatchAttributes,
        };
        this.resource = ruleDefinition;
    }
    /**
     * Calculate the address capacity requirements by number of address ranges.
     */
    calculateAddressCapacity(locations) {
        var capacity = 0;
        var cidrs;
        if (locations !== undefined) {
            for (cidrs of locations) {
                capacity += cidrs.split(',').length;
            }
        }
        // always return at least 1, for an undefined set meaning "ANY"
        return capacity || 1;
    }
    /**
     * Calculate Rule Capacity Reqirements.
     * https://docs.aws.amazon.com/network-firewall/latest/developerguide/rule-group-managing.html#nwfw-rule-group-capacity
     */
    calculateCapacity() {
        let capacity = 1;
        capacity *= this.calculateAddressCapacity(this.destinations);
        capacity *= this.destinationPorts.length || 1;
        capacity *= this.calculateAddressCapacity(this.sources);
        capacity *= this.sourcePorts.length || 1;
        capacity *= this.protocols.length || 1;
        return capacity;
    }
}
exports.StatelessRule = StatelessRule;
/**
 * The direction of traffic flow to inspect.
 */
var Stateful5TupleDirection;
(function (Stateful5TupleDirection) {
    /**
     * Inspection matches bidirectional traffic, both from the source to the destination and from the destination to the source.
     */
    Stateful5TupleDirection["ANY"] = "ANY";
    /**
     * Inspection only matches traffic going from the source to the destination.
     */
    Stateful5TupleDirection["FORWARD"] = "FORWARD";
})(Stateful5TupleDirection || (exports.Stateful5TupleDirection = Stateful5TupleDirection = {}));
/**
 * The shared base class of stateful rules.
 */
class StatefulRuleBase {
}
exports.StatefulRuleBase = StatefulRuleBase;
/**
 * Generates a Stateful Rule from a 5 Tuple
 */
class Stateful5TupleRule extends StatefulRuleBase {
    constructor(props) {
        super();
        const protocol = props.protocol || 'IP';
        const destination = props.destination || 'ANY';
        const destinationPort = props.destinationPort || 'ANY';
        const source = props.source || 'ANY';
        const sourcePort = props.sourcePort || 'ANY';
        const direction = props.direction || Stateful5TupleDirection.ANY;
        const resourceHeader = {
            destination: destination,
            destinationPort: destinationPort,
            source: source,
            sourcePort: sourcePort,
            protocol: protocol,
            direction: direction,
        };
        const resourceOptions = props.ruleOptions || [];
        const resource = {
            action: props.action,
            header: resourceHeader,
            ruleOptions: resourceOptions,
        };
        this.resource = resource;
    }
}
exports.Stateful5TupleRule = Stateful5TupleRule;
/**
 * The type of domain list to generate
 */
var StatefulDomainListType;
(function (StatefulDomainListType) {
    /**
     * Deny domain(s) through
     */
    StatefulDomainListType["DENYLIST"] = "DENYLIST";
    /**
     * Allow domain(s) through
     */
    StatefulDomainListType["ALLOWLIST"] = "ALLOWLIST";
})(StatefulDomainListType || (exports.StatefulDomainListType = StatefulDomainListType = {}));
/**
 * The types of targets to inspect for.
 *  You can inspect HTTP or HTTPS protocols, or both.
 */
var StatefulDomainListTargetType;
(function (StatefulDomainListTargetType) {
    /**
     * Target HTTPS traffic
     * For HTTPS traffic, Network Firewall uses the Server Name Indication (SNI) extension in the TLS handshake to determine the hostname, or domain name, that the client is trying to connect to
     */
    StatefulDomainListTargetType["TLS_SNI"] = "TLS_SNI";
    /**
     * Target HTTP traffic
     */
    StatefulDomainListTargetType["HTTP_HOST"] = "HTTP_HOST";
})(StatefulDomainListTargetType || (exports.StatefulDomainListTargetType = StatefulDomainListTargetType = {}));
/**
 * Generates a Statful Rule from a Domain List
 */
class StatefulDomainListRule extends StatefulRuleBase {
    constructor(props) {
        super();
        const resource = {
            generatedRulesType: props.type,
            targets: props.targets,
            targetTypes: props.targetTypes,
        };
        this.resource = resource;
    }
}
exports.StatefulDomainListRule = StatefulDomainListRule;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicnVsZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInJ1bGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsdUNBQTRFO0FBRTVFLHlEQUE2RDtBQU83RDs7R0FFRztBQUNILE1BQWUsaUJBQWlCO0NBQTZCO0FBMEQ3RDs7R0FFRztBQUNILE1BQWEsYUFBYyxTQUFRLGlCQUFpQjtJQVlsRCxZQUFhLEtBQXlCO1FBQ3BDLEtBQUssRUFBRSxDQUFDO1FBRVIscUJBQXFCO1FBRXJCOztXQUVHO1FBQ0gsK0NBQStDO1FBQy9DLElBQUksd0JBQXdCLEdBQVMsS0FBSyxDQUFDO1FBQzNDLElBQUksTUFBYSxDQUFDO1FBQ2xCLEtBQUssTUFBTSxJQUFJLEtBQUssQ0FBQyxPQUFPLEVBQUU7WUFDNUIsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFTLGlDQUF1QixDQUFDLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxFQUFFO2dCQUNuRSxJQUFJLHdCQUF3QixFQUFFO29CQUM1QixNQUFNLElBQUksS0FBSyxDQUFDLDRFQUE0RSxDQUFDLENBQUM7aUJBQy9GO2dCQUNELHdCQUF3QixHQUFDLElBQUksQ0FBQzthQUMvQjtTQUNGO1FBRUQ7OztXQUdHO1FBQ0gsSUFBSSxDQUFDLFlBQVksR0FBRyxLQUFLLENBQUMsWUFBWSxJQUFJLEVBQUUsQ0FBQztRQUM3QyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsS0FBSyxDQUFDLGdCQUFnQixJQUFJLEVBQUUsQ0FBQztRQUNyRCxJQUFJLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQyxPQUFPLElBQUksRUFBRSxDQUFDO1FBQ25DLElBQUksQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDLFdBQVcsSUFBSSxFQUFFLENBQUM7UUFDM0MsSUFBSSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUMsU0FBUyxJQUFJLEVBQUUsQ0FBQztRQUV2QyxNQUFNLFlBQVksR0FBa0MsSUFBQSxrQ0FBbUIsRUFBQyxLQUFLLENBQUMsWUFBWSxD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WUFDbEIsU0FBUyxFQUFFLFNBQVM7U0FDckIsQ0FBQztRQUVGLE1BQU0sZUFBZSxHQUFxQyxLQUFLLENBQUMsV0FBVyxJQUFJLEVBQUUsQ0FBQztRQUVsRixNQUFNLFFBQVEsR0FBcUM7WUFDakQsTUFBTSxFQUFFLEtBQUssQ0FBQyxNQUFNO1lBQ3BCLE1BQU0sRUFBRSxjQUFjO1lBQ3RCLFdBQVcsRUFBRSxlQUFlO1NBQzdCLENBQUM7UUFDRixJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQztJQUMzQixDQUFDO0NBQ0Y7QUFsQ0QsZ0RBa0NDO0FBRUQ7O0dBRUc7QUFDSCxJQUFZLHNCQVVYO0FBVkQsV0FBWSxzQkFBc0I7SUFDaEM7O09BRUc7SUFDSCwrQ0FBbUIsQ0FBQTtJQUVuQjs7T0FFRztJQUNILGlEQUFxQixDQUFBO0FBQ3ZCLENBQUMsRUFWVyxzQkFBc0Isc0NBQXRCLHNCQUFzQixRQVVqQztBQUVEOzs7R0FHRztBQUNILElBQVksNEJBV1g7QUFYRCxXQUFZLDRCQUE0QjtJQUN0Qzs7O09BR0c7SUFDSCxtREFBaUIsQ0FBQTtJQUVqQjs7T0FFRztJQUNILHVEQUFxQixDQUFBO0FBQ3ZCLENBQUMsRUFYVyw0QkFBNEIsNENBQTVCLDRCQUE0QixRQVd2QztBQXNCRDs7R0FFRztBQUNILE1BQWEsc0JBQXVCLFNBQVEsZ0JBQWdCO0lBTTFELFlBQVksS0FBaUM7UUFDM0MsS0FBSyxFQUFFLENBQUM7UUFDUixNQUFNLFFBQVEsR0FBd0M7WUFDcEQsa0JBQWtCLEVBQUUsS0FBSyxDQUFDLElBQUk7WUFDOUIsT0FBTyxFQUFFLEtBQUssQ0FBQyxPQUFPO1lBQ3RCLFdBQVcsRUFBRSxLQUFLLENBQUMsV0FBVztTQUMvQixDQUFDO1FBRUYsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7SUFDM0IsQ0FBQztDQUNGO0FBaEJELHdEQWdCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFN0YXRlZnVsU3RhbmRhcmRBY3Rpb24sIFN0YXRlbGVzc1N0YW5kYXJkQWN0aW9uIH0gZnJvbSAnLi9hY3Rpb25zJztcbmltcG9ydCB7IENmblJ1bGVHcm91cCB9IGZyb20gJ2F3cy1jZGstbGliL2F3cy1uZXR3b3JrZmlyZXdhbGwnO1xuaW1wb3J0IHsgY2FzdEFkZHJlc3NQcm9wZXJ0eSB9IGZyb20gJy4vcHJpdmF0ZS9ydWxlcy1jb21tb24nO1xuXG4vKipcbiAqIFRoZSBpbnRlcmZhY2UgdGhhdCByZXByZXNlbnRzIHRoZSB2YWx1ZXMgb2YgYSBTdGF0ZWxlc3NSdWxlXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSVN0YXRlbGVzc1J1bGV7fVxuXG4vKipcbiAqIFRoZSBiYXNlIGNsYXNzIG9mIFN0YXRlbGVzcyBSdWxlc1xuICovXG5hYnN0cmFjdCBjbGFzcyBTdGF0ZWxlc3NSdWxlQmFzZSBpbXBsZW1lbnRzIElTdGF0ZWxlc3NSdWxlIHt9XG5cbi8qKlxuICogUHJvcGVydGllcyBmb3IgZGVmaW5pbmcgYSBzdGF0ZWxlc3MgcnVsZVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFN0YXRlbGVzc1J1bGVQcm9wcyB7XG4gIC8qKlxuICAgKiBSdWxlIEFjdGlvbnNcbiAgICpcbiAgICogVGhlIGFjdGlvbnMgdG8gdGFrZSBvbiBhIHBhY2tldCB0aGF0IG1hdGNoZXMgb25lIG9mIHRoZSBzdGF0ZWxlc3MgcnVsZSBkZWZpbml0aW9uJ3MgbWF0Y2ggYXR0cmlidXRlcy5cbiAgICovXG4gIHJlYWRvbmx5IGFjdGlvbnM6IChTdGF0ZWxlc3NTdGFuZGFyZEFjdGlvbnxzdHJpbmcpW107XG5cbiAgLyoqXG4gICAqIFRoZSBkZXN0aW5hdGlvbiBwb3J0IHRvIGluc3BlY3QgZm9yLlxuICAgKiBZb3UgY2FuIHNwZWNpZnkgYW4gaW5kaXZpZHVhbCBwb3J0LCBmb3IgZXhhbXBsZSAxOTk0IGFuZCB5b3UgY2FuIHNwZWNpZnkgYSBwb3J0IHJhbmdlLCBmb3IgZXhhbXBsZSAxOTkwOjE5OTQuXG4gICAqIFRvIG1hdGNoIHdpdGggYW55IHBvcnQsIHNwZWNpZnkgQU5ZLlxuICAgKlxuICAgKiBAZGVmYXVsdCAtIEFOWVxuICAgKi9cbiAgcmVhZG9ubHkgZGVzdGluYXRpb25Qb3J0cz86IENmblJ1bGVHcm91cC5Qb3J0UmFuZ2VQcm9wZXJ0eVtdO1xuXG4gIC8qKlxuICAgKiBTcGVjaWZ5IGFuIGFycmF5IG9mIElQIGFkZHJlc3Mgb3IgYSBibG9jayBvZiBJUCBhZGRyZXNzZXMgaW4gQ2xhc3NsZXNzIEludGVyLURvbWFpbiBSb3V0aW5nIChDSURSKSBub3RhdGlvbi5cbiAgICpcbiAgICogQGRlZmF1bHQgLSBBTllcbiAgICovXG4gIHJlYWRvbmx5IGRlc3RpbmF0aW9ucz86IHN0cmluZ1tdO1xuXG4gIC8qKlxuICAgKiBUaGUgcHJvdG9jb2xzIHRvIGluc3BlY3QgZm9yLCBzcGVjaWZpZWQgdXNpbmcgZWFjaCBwcm90b2NvbCdzIGFzc2lnbmVkIGludGVybmV0IHByb3RvY29sIG51bWJlciAoSUFOQSkuXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gQU5ZXG4gICAqL1xuICByZWFkb25seSBwcm90b2NvbHM/OiBudW1iZXJbXTtcblxuICAvKipcbiAgICogVGhlIHNvdXJjZSBwb3J0cyB0byBpbnNwZWN0IGZvci5cbiAgICpcbiAgICogQGRlZmF1bHQgLSBBTllcbiAgICovXG4gIHJlYWRvbmx5IHNvdXJjZVBvcnRzPzogQ2ZuUnVsZUdyb3VwLlBvcnRSYW5nZVByb3BlcnR5W107XG5cbiAgLyoqXG4gICAqIFNwZWNpZnkgYW4gYXJyYXkgb2YgSVAgYWRkcmVzcyBvciBhIGJsb2NrIG9mIElQIGFkZHJlc3NlcyBpbiBDbGFzc2xlc3MgSW50ZXItRG9tYWluIFJvdXRpbmcgKENJRFIpIG5vdGF0aW9uLlxuICAgKlxuICAgKiBAZGVmYXVsdCAtIEFOWVxuICAgKi9cbiAgcmVhZG9ubHkgc291cmNlcz86IHN0cmluZ1tdO1xuXG4gIC8qKlxuICAgKiBUQ1AgZmxhZ3MgYW5kIG1hc2tzIHRvIGluc3BlY3QgcGFja2V0cyBmb3IuXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gdW5kZWZpbmVkXG4gICAqL1xuICByZWFkb25seSB0Y3BGbGFncz86IENmblJ1bGVHcm91cC5UQ1BGbGFnRmllbGRQcm9wZXJ0eVtdO1xufVxuXG4vKipcbiAqIERlZmluZXMgYSBOZXR3b3JrIEZpcmV3YWxsIFN0YXRlbGVzcyBSdWxlXG4gKi9cbmV4cG9ydCBjbGFzcyBTdGF0ZWxlc3NSdWxlIGV4dGVuZHMgU3RhdGVsZXNzUnVsZUJhc2Uge1xuICBwcml2YXRlIHJlYWRvbmx5IGRlc3RpbmF0aW9uczogc3RyaW5nW107XG4gIHByaXZhdGUgcmVhZG9ubHkgZGVzdGluYXRpb25Qb3J0czogQ2ZuUnVsZUdyb3VwLlBvcnRSYW5nZVByb3BlcnR5W107XG4gIHByaXZhdGUgcmVhZG9ubHkgc291cmNlczogc3RyaW5nW107XG4gIHByaXZhdGUgcmVhZG9ubHkgc291cmNlUG9ydHM6IENmblJ1bGVHcm91cC5Qb3J0UmFuZ2VQcm9wZXJ0eVtdO1xuICBwcml2YXRlIHJlYWRvbmx5IHByb3RvY29sczogbnVtYmVyW107XG5cbiAgLyoqXG4gICAqIFRoZSBMMSBTdGF0ZWxlc3MgUnVsZSBQcm9wZXJ0eVxuICAgKiBAYXR0cmlidXRlXG4gICAqL1xuICBwdWJsaWMgcmVzb3VyY2U6IENmblJ1bGVHcm91cC5SdWxlRGVmaW5pdGlvblByb3BlcnR5O1xuICBjb25zdHJ1Y3RvciggcHJvcHM6IFN0YXRlbGVzc1J1bGVQcm9wcykge1xuICAgIHN1cGVyKCk7XG5cbiAgICAvLyBBZGRpbmcgVmFsaWRhdGlvbnNcblxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRpbmcgQWN0aW9uc1xuICAgICAqL1xuICAgIC8vIEVuc3VyZSBvbmx5IG9uZSBzdGFuZGFyZCBhY3Rpb24gaXMgcHJvdmlkZWQuXG4gICAgbGV0IHN0YW5kYXJkX2FjdGlvbl9wcm92aWRlZDpib29sZWFuPWZhbHNlO1xuICAgIGxldCBhY3Rpb246c3RyaW5nO1xuICAgIGZvciAoYWN0aW9uIG9mIHByb3BzLmFjdGlvbnMpIHtcbiAgICAgIGlmIChPYmplY3QudmFsdWVzPHN0cmluZz4oU3RhdGVsZXNzU3RhbmRhcmRBY3Rpb24pLmluY2x1ZGVzKGFjdGlvbikpIHtcbiAgICAgICAgaWYgKHN0YW5kYXJkX2FjdGlvbl9wcm92aWRlZCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignT25seSBvbmUgc3RhbmRhcmQgYWN0aW9uIGNhbiBiZSBwcm92aWRlZCwgYWxsIG90aGVyIGFjdGlvbnMgbXVzdCBiZSBjdXN0b20nKTtcbiAgICAgICAgfVxuICAgICAgICBzdGFuZGFyZF9hY3Rpb25fcHJvdmlkZWQ9dHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTYXZpbmcgdG8gb2JqZWN0IGZvciBmdXJ0dXJlIGNhcGFjaXR5IGNhbGN1bGF0aW9ucy5cbiAgICAgKiBDYXBhY2l0eSBjYW4ndCBiZSBjYWxjdWxhdGVkIHllcyBzaW5jZSBwcm9wcyBjYW4gYmUgdXBkYXRlZFxuICAgICAqL1xuICAgIHRoaXMuZGVzdGluYXRpb25zID0gcHJvcHMuZGVzdGluYXRpb25zIHx8IFtdO1xuICAgIHRoaXMuZGVzdGluYXRpb25Qb3J0cyA9IHByb3BzLmRlc3RpbmF0aW9uUG9ydHMgfHwgW107XG4gICAgdGhpcy5zb3VyY2VzID0gcHJvcHMuc291cmNlcyB8fCBbXTtcbiAgICB0aGlzLnNvdXJjZVBvcnRzID0gcHJvcHMuc291cmNlUG9ydHMgfHwgW107XG4gICAgdGhpcy5wcm90b2NvbHMgPSBwcm9wcy5wcm90b2NvbHMgfHwgW107XG5cbiAgICBjb25zdCBkZXN0aW5hdGlvbnM6Q2ZuUnVsZUdyb3VwLkFkZHJlc3NQcm9wZXJ0eVtdID0gY2FzdEFkZHJlc3NQcm9wZXJ0eShwcm9wcy5kZXN0aW5hdGlvbnMpO1xuXG4gICAgY29uc3Qgc291cmNlczpDZm5SdWxlR3JvdXAuQWRkcmVzc1Byb3BlcnR5W10gPSBjYXN0QWRkcmVzc1Byb3BlcnR5KHByb3BzLnNvdXJjZXMpO1xuXG4gICAgY29uc3QgcnVsZU1hdGNoQXR0cmlidXRlczpDZm5SdWxlR3JvdXAuTWF0Y2hBdHRyaWJ1dGVzUHJvcGVydHkgPSB7XG4gICAgICBkZXN0aW5hdGlvblBvcnRzOiBwcm9wcy5kZXN0aW5hdGlvblBvcnRzLFxuICAgICAgZGVzdGluYXRpb25zOiBkZXN0aW5hdGlvbnMsXG4gICAgICBzb3VyY2VQb3J0czogcHJvcHMuc291cmNlUG9ydHMsXG4gICAgICBzb3VyY2VzOiBzb3VyY2VzLFxuICAgICAgcHJvdG9jb2xzOiBwcm9wcy5wcm90b2NvbHMsXG4gICAgICB0Y3BGbGFnczogcHJvcHMudGNwRmxhZ3MsXG4gICAgfTtcblxuICAgIGNvbnN0IHJ1bGVEZWZpbml0aW9uOkNmblJ1bGVHcm91cC5SdWxlRGVmaW5pdGlvblByb3BlcnR5ID0ge1xuICAgICAgYWN0aW9uczogcHJvcHMuYWN0aW9ucyxcbiAgICAgIG1hdGNoQXR0cmlidXRlczogcnVsZU1hdGNoQXR0cmlidXRlcyxcbiAgICB9O1xuXG4gICAgdGhpcy5yZXNvdXJjZSA9IHJ1bGVEZWZpbml0aW9uO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSB0aGUgYWRkcmVzcyBjYXBhY2l0eSByZXF1aXJlbWVudHMgYnkgbnVtYmVyIG9mIGFkZHJlc3MgcmFuZ2VzLlxuICAgKi9cbiAgcHJpdmF0ZSBjYWxjdWxhdGVBZGRyZXNzQ2FwYWNpdHkobG9jYXRpb25zOnN0cmluZ1tdfHVuZGVmaW5lZCk6bnVtYmVyIHtcbiAgICB2YXIgY2FwYWNpdHk6bnVtYmVyID0gMDtcbiAgICB2YXIgY2lkcnM6c3RyaW5nO1xuICAgIGlmIChsb2NhdGlvbnMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZm9yIChjaWRycyBvZiBsb2NhdGlvbnMpIHtcbiAgICAgICAgY2FwYWNpdHkgKz0gY2lkcnMuc3BsaXQoJywnKS5sZW5ndGg7XG4gICAgICB9XG4gICAgfVxuICAgIC8vIGFsd2F5cyByZXR1cm4gYXQgbGVhc3QgMSwgZm9yIGFuIHVuZGVmaW5lZCBzZXQgbWVhbmluZyBcIkFOWVwiXG4gICAgcmV0dXJuIGNhcGFjaXR5IHx8IDE7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlIFJ1bGUgQ2FwYWNpdHkgUmVxaXJlbWVudHMuXG4gICAqIGh0dHBzOi8vZG9jcy5hd3MuYW1hem9uLmNvbS9uZXR3b3JrLWZpcmV3YWxsL2xhdGVzdC9kZXZlbG9wZXJndWlkZS9ydWxlLWdyb3VwLW1hbmFnaW5nLmh0bWwjbndmdy1ydWxlLWdyb3VwLWNhcGFjaXR5XG4gICAqL1xuICBwdWJsaWMgY2FsY3VsYXRlQ2FwYWNpdHkoKTpudW1iZXIge1xuICAgIGxldCBjYXBhY2l0eTpudW1iZXIgPSAxO1xuXG4gICAgY2FwYWNpdHkgKj0gdGhpcy5jYWxjdWxhdGVBZGRyZXNzQ2FwYWNpdHkodGhpcy5kZXN0aW5hdGlvbnMpO1xuICAgIGNhcGFjaXR5ICo9IHRoaXMuZGVzdGluYXRpb25Qb3J0cy5sZW5ndGggfHwgMTtcbiAgICBjYXBhY2l0eSAqPSB0aGlzLmNhbGN1bGF0ZUFkZHJlc3NDYXBhY2l0eSh0aGlzLnNvdXJjZXMpO1xuICAgIGNhcGFjaXR5ICo9IHRoaXMuc291cmNlUG9ydHMubGVuZ3RoIHx8IDE7XG4gICAgY2FwYWNpdHkgKj0gdGhpcy5wcm90b2NvbHMubGVuZ3RoIHx8IDE7XG4gICAgcmV0dXJuIGNhcGFjaXR5O1xuICB9XG59XG5cbi8qKlxuICogVGhlIGRpcmVjdGlvbiBvZiB0cmFmZmljIGZsb3cgdG8gaW5zcGVjdC5cbiAqL1xuZXhwb3J0IGVudW0gU3RhdGVmdWw1VHVwbGVEaXJlY3Rpb24ge1xuICAvKipcbiAgICogSW5zcGVjdGlvbiBtYXRjaGVzIGJpZGlyZWN0aW9uYWwgdHJhZmZpYywgYm90aCBmcm9tIHRoZSBzb3VyY2UgdG8gdGhlIGRlc3RpbmF0aW9uIGFuZCBmcm9tIHRoZSBkZXN0aW5hdGlvbiB0byB0aGUgc291cmNlLlxuICAgKi9cbiAgQU5ZID0gJ0FOWScsXG5cbiAgLyoqXG4gICAqIEluc3BlY3Rpb24gb25seSBtYXRjaGVzIHRyYWZmaWMgZ29pbmcgZnJvbSB0aGUgc291cmNlIHRvIHRoZSBkZXN0aW5hdGlvbi5cbiAgICovXG4gIEZPUldBUkQgPSAnRk9SV0FSRCcsXG59XG5cbi8qKlxuICogVGhlIGludGVyZmFjZSB0aGF0IHJlcHJlc2VudHMgdGhlIHNoYXJlZCB2YWx1ZXMgb2YgdGhlIFN0YXRlZnVsUnVsZXNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJU3RhdGVmdWxSdWxlIHt9XG5cbi8qKlxuICogVGhlIHByb3BlcnRpZXMgZm9yIGRlZmluaW5nIGEgZ2VuZXJpYyBTdGF0ZWZ1bCBSdWxlXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU3RhdGVmdWxSdWxlQmFzZVByb3BzIHt9XG5cbi8qKlxuICogVGhlIHNoYXJlZCBiYXNlIGNsYXNzIG9mIHN0YXRlZnVsIHJ1bGVzLlxuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgU3RhdGVmdWxSdWxlQmFzZSBpbXBsZW1lbnRzIElTdGF0ZWZ1bFJ1bGUge31cblxuLyoqXG4gKiBQcm9wZXJ0aWVzIGZvciBkZWZpbmluZyBhIDUgVHVwbGUgcnVsZVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFN0YXRlZnVsNVR1cGxlUnVsZVByb3BzIGV4dGVuZHMgU3RhdGVmdWxSdWxlQmFzZVByb3BzIHtcbiAgLyoqXG4gICAqIFRoZSBhY3Rpb24gdG8gcGVyZm9ybSB3aGVuIGEgcnVsZSBpcyBtYXRjaGVkLlxuICAgKi9cbiAgcmVhZG9ubHkgYWN0aW9uOiBTdGF0ZWZ1bFN0YW5kYXJkQWN0aW9ufHN0cmluZztcblxuICAvKipcbiAgICogVGhlIGRlc3RpbmF0aW9uIHBvcnQgdG8gaW5zcGVjdCBmb3IuXG4gICAqIFlvdSBjYW4gc3BlY2lmeSBhbiBpbmRpdmlkdWFsIHBvcnQsIGZvciBleGFtcGxlIDE5OTQgYW5kIHlvdSBjYW4gc3BlY2lmeSBhIHBvcnQgcmFuZ2UsIGZvciBleGFtcGxlIDE5OTA6MTk5NCAuXG4gICAqIFRvIG1hdGNoIHdpdGggYW55IHBvcnQsIHNwZWNpZnkgQU5ZXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gQU5ZXG4gICAqL1xuICByZWFkb25seSBkZXN0aW5hdGlvblBvcnQ/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFNwZWNpZnkgYW4gYXJyYXkgb2YgSVAgYWRkcmVzcyBvciBhIGJsb2NrIG9mIElQIGFkZHJlc3NlcyBpbiBDbGFzc2xlc3MgSW50ZXItRG9tYWluIFJvdXRpbmcgKENJRFIpIG5vdGF0aW9uLlxuICAgKlxuICAgKiBAZGVmYXVsdCA9IEFOWVxuICAgKi9cbiAgcmVhZG9ubHkgZGVzdGluYXRpb24/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBwcm90b2NvbCB0byBpbnNwZWN0IGZvci5cbiAgICogVG8gc3BlY2lmeSBhbGwsIHlvdSBjYW4gdXNlIElQICwgYmVjYXVzZSBhbGwgdHJhZmZpYyBvbiBBV1MgYW5kIG9uIHRoZSBpbnRlcm5ldCBpcyBJUC5cbiAgICpcbiAgICogQGRlZmF1bHQgLSBJUFxuICAgKi9cbiAgcmVhZG9ubHkgcHJvdG9jb2w/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBzb3VyY2UgSVAgYWRkcmVzcyBvciBhZGRyZXNzIHJhbmdlIHRvIGluc3BlY3QgZm9yLCBpbiBDSURSIG5vdGF0aW9uLlxuICAgKiBUbyBtYXRjaCB3aXRoIGFueSBhZGRyZXNzLCBzcGVjaWZ5IEFOWS5cbiAgICpcbiAgICogQGRlZmF1bHQgLSBBTllcbiAgICovXG4gIHJlYWRvbmx5IHNvdXJjZVBvcnQ/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFNwZWNpZnkgYW4gYXJyYXkgb2YgSVAgYWRkcmVzcyBvciBhIGJsb2NrIG9mIElQIGFkZHJlc3NlcyBpbiBDbGFzc2xlc3MgSW50ZXItRG9tYWluIFJvdXRpbmcgKENJRFIpIG5vdGF0aW9uLlxuICAgKlxuICAgKiBAZGVmYXVsdCA9IEFOWVxuICAgKi9cbiAgcmVhZG9ubHkgc291cmNlPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBBZGRpdGlvbmFsIHNldHRpbmdzIGZvciBhIHN0YXRlZnVsIHJ1bGUsIHByb3ZpZGVkIGFzIGtleXdvcmRzIGFuZCBzZXR0dGluZ3MuXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gdW5kZWZpbmVkXG4gICAqL1xuICByZWFkb25seSBydWxlT3B0aW9ucz86IENmblJ1bGVHcm91cC5SdWxlT3B0aW9uUHJvcGVydHlbXTtcblxuICAvKipcbiAgICogVGhlIGRpcmVjdGlvbiBvZiB0cmFmZmljIGZsb3cgdG8gaW5zcGVjdC5cbiAgICogSWYgc2V0IHRvIEFOWSwgdGhlIGluc3BlY3Rpb24gbWF0Y2hlcyBiaWRpcmVjdGlvbmFsIHRyYWZmaWMsIGJvdGggZnJvbSB0aGUgc291cmNlIHRvIHRoZSBkZXN0aW5hdGlvbiBhbmQgZnJvbSB0aGUgZGVzdGluYXRpb24gdG8gdGhlIHNvdXJjZS5cbiAgICogSWYgc2V0IHRvIEZPUldBUkQgLCB0aGUgaW5zcGVjdGlvbiBvbmx5IG1hdGNoZXMgdHJhZmZpYyBnb2luZyBmcm9tIHRoZSBzb3VyY2UgdG8gdGhlIGRlc3RpbmF0aW9uLlxuICAgKlxuICAgKiBAZGVmYXVsdCAtIEFOWVxuICAgKi9cbiAgcmVhZG9ubHkgZGlyZWN0aW9uPzogU3RhdGVmdWw1VHVwbGVEaXJlY3Rpb24gfCBzdHJpbmc7XG59XG5cbi8qKlxuICogR2VuZXJhdGVzIGEgU3RhdGVmdWwgUnVsZSBmcm9tIGEgNSBUdXBsZVxuICovXG5leHBvcnQgY2xhc3MgU3RhdGVmdWw1VHVwbGVSdWxlIGV4dGVuZHMgU3RhdGVmdWxSdWxlQmFzZSB7XG4gIC8qKlxuICAgKiBUaGUgTDEgU3RhdGVmdWwgUnVsZSBQcm9wZXJ0eVxuICAgKiBAYXR0cmlidXRlXG4gICAqL1xuICBwdWJsaWMgcmVzb3VyY2U6Q2ZuUnVsZUdyb3VwLlN0YXRlZnVsUnVsZVByb3BlcnR5O1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOlN0YXRlZnVsNVR1cGxlUnVsZVByb3BzKSB7XG4gICAgc3VwZXIoKTtcbiAgICBjb25zdCBwcm90b2NvbDpzdHJpbmcgPSBwcm9wcy5wcm90b2NvbCB8fCAnSVAnO1xuICAgIGNvbnN0IGRlc3RpbmF0aW9uOnN0cmluZyA9IHByb3BzLmRlc3RpbmF0aW9uIHx8ICdBTlknO1xuICAgIGNvbnN0IGRlc3RpbmF0aW9uUG9ydDpzdHJpbmcgPSBwcm9wcy5kZXN0aW5hdGlvblBvcnQgfHwgJ0FOWSc7XG4gICAgY29uc3Qgc291cmNlOnN0cmluZyA9IHByb3BzLnNvdXJjZSB8fCAnQU5ZJztcbiAgICBjb25zdCBzb3VyY2VQb3J0OnN0cmluZyA9IHByb3BzLnNvdXJjZVBvcnQgfHwgJ0FOWSc7XG4gICAgY29uc3QgZGlyZWN0aW9uOnN0cmluZyA9IHByb3BzLmRpcmVjdGlvbiB8fCBTdGF0ZWZ1bDVUdXBsZURpcmVjdGlvbi5BTlk7XG5cbiAgICBjb25zdCByZXNvdXJjZUhlYWRlcjpDZm5SdWxlR3JvdXAuSGVhZGVyUHJvcGVydHkgPSB7XG4gICAgICBkZXN0aW5hdGlvbjogZGVzdGluYXRpb24sXG4gICAgICBkZXN0aW5hdGlvblBvcnQ6IGRlc3RpbmF0aW9uUG9ydCxcbiAgICAgIHNvdXJjZTogc291cmNlLFxuICAgICAgc291cmNlUG9ydDogc291cmNlUG9ydCxcbiAgICAgIHByb3RvY29sOiBwcm90b2NvbCxcbiAgICAgIGRpcmVjdGlvbjogZGlyZWN0aW9uLFxuICAgIH07XG5cbiAgICBjb25zdCByZXNvdXJjZU9wdGlvbnM6Q2ZuUnVsZUdyb3VwLlJ1bGVPcHRpb25Qcm9wZXJ0eVtdID0gcHJvcHMucnVsZU9wdGlvbnMgfHwgW107XG5cbiAgICBjb25zdCByZXNvdXJjZTpDZm5SdWxlR3JvdXAuU3RhdGVmdWxSdWxlUHJvcGVydHkgPSB7XG4gICAgICBhY3Rpb246IHByb3BzLmFjdGlvbixcbiAgICAgIGhlYWRlcjogcmVzb3VyY2VIZWFkZXIsXG4gICAgICBydWxlT3B0aW9uczogcmVzb3VyY2VPcHRpb25zLFxuICAgIH07XG4gICAgdGhpcy5yZXNvdXJjZSA9IHJlc291cmNlO1xuICB9XG59XG5cbi8qKlxuICogVGhlIHR5cGUgb2YgZG9tYWluIGxpc3QgdG8gZ2VuZXJhdGVcbiAqL1xuZXhwb3J0IGVudW0gU3RhdGVmdWxEb21haW5MaXN0VHlwZXtcbiAgLyoqXG4gICAqIERlbnkgZG9tYWluKHMpIHRocm91Z2hcbiAgICovXG4gIERFTllMSVNUPSdERU5ZTElTVCcsXG5cbiAgLyoqXG4gICAqIEFsbG93IGRvbWFpbihzKSB0aHJvdWdoXG4gICAqL1xuICBBTExPV0xJU1Q9J0FMTE9XTElTVCcsXG59XG5cbi8qKlxuICogVGhlIHR5cGVzIG9mIHRhcmdldHMgdG8gaW5zcGVjdCBmb3IuXG4gKiAgWW91IGNhbiBpbnNwZWN0IEhUVFAgb3IgSFRUUFMgcHJvdG9jb2xzLCBvciBib3RoLlxuICovXG5leHBvcnQgZW51bSBTdGF0ZWZ1bERvbWFpbkxpc3RUYXJnZXRUeXBle1xuICAvKipcbiAgICogVGFyZ2V0IEhUVFBTIHRyYWZmaWNcbiAgICogRm9yIEhUVFBTIHRyYWZmaWMsIE5ldHdvcmsgRmlyZXdhbGwgdXNlcyB0aGUgU2VydmVyIE5hbWUgSW5kaWNhdGlvbiAoU05JKSBleHRlbnNpb24gaW4gdGhlIFRMUyBoYW5kc2hha2UgdG8gZGV0ZXJtaW5lIHRoZSBob3N0bmFtZSwgb3IgZG9tYWluIG5hbWUsIHRoYXQgdGhlIGNsaWVudCBpcyB0cnlpbmcgdG8gY29ubmVjdCB0b1xuICAgKi9cbiAgVExTX1NOST0nVExTX1NOSScsXG5cbiAgLyoqXG4gICAqIFRhcmdldCBIVFRQIHRyYWZmaWNcbiAgICovXG4gIEhUVFBfSE9TVD0nSFRUUF9IT1NUJyxcbn1cblxuLyoqXG4gKiBUaGUgcHJvcGVydGllcyBmb3IgZGVmaW5pbmcgYSBTdGF0ZWZ1bCBEb21haW4gTGlzdCBSdWxlXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU3RhdGVmdWxEb21haW5MaXN0UnVsZVByb3BzIGV4dGVuZHMgU3RhdGVmdWxSdWxlQmFzZVByb3BzIHtcbiAgLyoqXG4gICAqIFdoZXRoZXIgeW91IHdhbnQgdG8gYWxsb3cgb3IgZGVueSBhY2Nlc3MgdG8gdGhlIGRvbWFpbnMgaW4geW91ciB0YXJnZXQgbGlzdC5cbiAgICovXG4gIHJlYWRvbmx5IHR5cGU6IFN0YXRlZnVsRG9tYWluTGlzdFR5cGUgfCBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBkb21haW5zIHRoYXQgeW91IHdhbnQgdG8gaW5zcGVjdCBmb3IgaW4geW91ciB0cmFmZmljIGZsb3dzLlxuICAgKi9cbiAgcmVhZG9ubHkgdGFyZ2V0czogc3RyaW5nW107XG5cbiAgLyoqXG4gICAqIFRoZSB0eXBlcyBvZiB0YXJnZXRzIHRvIGluc3BlY3QgZm9yLlxuICAgKi9cbiAgcmVhZG9ubHkgdGFyZ2V0VHlwZXM6IChTdGF0ZWZ1bERvbWFpbkxpc3RUYXJnZXRUeXBlIHwgc3RyaW5nKVtdO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlcyBhIFN0YXRmdWwgUnVsZSBmcm9tIGEgRG9tYWluIExpc3RcbiAqL1xuZXhwb3J0IGNsYXNzIFN0YXRlZnVsRG9tYWluTGlzdFJ1bGUgZXh0ZW5kcyBTdGF0ZWZ1bFJ1bGVCYXNlIHtcbiAgLyoqXG4gICAqIFRoZSBMMSBTdGF0ZWZ1bCBSdWxlIFByb3BlcnR5XG4gICAqIEBhdHRyaWJ1dGVcbiAgICovXG4gIHB1YmxpYyByZXNvdXJjZTpDZm5SdWxlR3JvdXAuUnVsZXNTb3VyY2VMaXN0UHJvcGVydHk7XG4gIGNvbnN0cnVjdG9yKHByb3BzOlN0YXRlZnVsRG9tYWluTGlzdFJ1bGVQcm9wcykge1xuICAgIHN1cGVyKCk7XG4gICAgY29uc3QgcmVzb3VyY2U6Q2ZuUnVsZUdyb3VwLlJ1bGVzU291cmNlTGlzdFByb3BlcnR5ID0ge1xuICAgICAgZ2VuZXJhdGVkUnVsZXNUeXBlOiBwcm9wcy50eXBlLFxuICAgICAgdGFyZ2V0czogcHJvcHMudGFyZ2V0cyxcbiAgICAgIHRhcmdldFR5cGVzOiBwcm9wcy50YXJnZXRUeXBlcyxcbiAgICB9O1xuXG4gICAgdGhpcy5yZXNvdXJjZSA9IHJlc291cmNlO1xuICB9XG59Il19