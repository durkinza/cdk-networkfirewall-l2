"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.LoggingConfiguration = exports.CloudWatchLogLocation = exports.KinesisDataFirehoseLogLocation = exports.S3LogLocation = exports.LogLocationBase = exports.LogDestinationType = exports.LogType = void 0;
const aws_networkfirewall_1 = require("aws-cdk-lib/aws-networkfirewall");
const aws_s3_1 = require("aws-cdk-lib/aws-s3");
const core = require("aws-cdk-lib/core");
/**
 * The type of log to send.
 */
var LogType;
(function (LogType) {
    /**
     * Alert logs report traffic that matches a stateful rule with an action setting that sends an alert log message.
     */
    LogType["ALERT"] = "ALERT";
    /**
     * Flow logs are standard network traffic flow logs.
     */
    LogType["FLOW"] = "FLOW";
})(LogType || (exports.LogType = LogType = {}));
;
/**
 * The type of storage destination to send these logs to.
 */
var LogDestinationType;
(function (LogDestinationType) {
    /**
    * Store logs to CloudWatch log group.
    */
    LogDestinationType["CLOUDWATCH"] = "CloudWatchLogs";
    /**
     * Store logs to a Kinesis Data Firehose delivery stream.
     */
    LogDestinationType["KINESISDATAFIREHOSE"] = "KinesisDataFirehose";
    /**
     * Store logs to an S3 bucket.
     */
    LogDestinationType["S3"] = "S3";
})(LogDestinationType || (exports.LogDestinationType = LogDestinationType = {}));
;
;
;
/**
 * Base Log Location class
 */
class LogLocationBase {
    constructor(logDestinationType, props) {
        this.logType = props.logType;
        this.logDestinationType = logDestinationType;
    }
}
exports.LogLocationBase = LogLocationBase;
;
;
/**
 * Defines a S3 Bucket Logging configuration.
 */
class S3LogLocation extends LogLocationBase {
    constructor(props) {
        super(LogDestinationType.S3, props);
        this.logDestinationType = LogDestinationType.S3;
        this.logType = props.logType;
        // Throws and error if bucketName is invalid format.
        aws_s3_1.Bucket.validateBucketName(props.bucketName);
        if (props.prefix) {
            if (!/^[a-zA-Z0-9_.!*'()-]{1,}$/.test(props.prefix)) {
                throw new Error(`'prefix' must have only letters, numbers, hyphens, dots (.), underscores, parantheses, stars(*), and explaination points (!). Got: ${props.prefix}`);
            }
            this.logDestination = {
                bucketName: props.bucketName,
                prefix: props.prefix,
            };
        }
        else {
            this.logDestination = {
                bucketName: props.bucketName,
            };
        }
    }
}
exports.S3LogLocation = S3LogLocation;
;
;
/**
 * Defines a Kinesis Delivery Stream Logging Configuration.
 */
class KinesisDataFirehoseLogLocation extends LogLocationBase {
    constructor(props) {
        super(LogDestinationType.KINESISDATAFIREHOSE, props);
        this.logDestinationType = LogDestinationType.KINESISDATAFIREHOSE;
        this.logType = props.logType;
        // Throws and error if deliveryStream is invalid format.
        // skip validation for late-bound values.
        if (!core.Token.isUnresolved(props.deliveryStream)) {
            if (!/^[a-zA-Z0-9_.-]{1,64}$/.test(props.deliveryStream)) {
                // Throws and error if logGroup is invalid format.
                throw new Error(`'LogGroup' must have 1-64 characters of only letters, numbers, hyphens, dots (.), and underscores. Got: ${props.deliveryStream}`);
            }
        }
        this.logDestination = {
            deliveryStream: props.deliveryStream,
        };
    }
}
exports.KinesisDataFirehoseLogLocation = KinesisDataFirehoseLogLocation;
;
;
/**
 * Defines a Cloud Watch Log Group Logging Configuration.
 */
class CloudWatchLogLocation extends LogLocationBase {
    constructor(props) {
        super(LogDestinationType.CLOUDWATCH, props);
        this.logDestinationType = LogDestinationType.CLOUDWATCH;
        this.logType = props.logType;
        // skip validation for late-bound values.
        if (!core.Token.isUnresolved(props.logGroup)) {
            if (!/^[a-zA-Z-_0-9/.#]{1,512}$/.test(props.logGroup)) {
                // Throws and error if logGroup is invalid format.
                throw new Error(`'LogGroup' must have 1-512 characters of only letters, numbers, hyphens, underscores, and pounds (#). Got: ${props.logGroup} `);
            }
        }
        this.logDestination = {
            logGroup: props.logGroup,
        };
    }
}
exports.CloudWatchLogLocation = CloudWatchLogLocation;
;
;
;
/**
 * Defines a Logging Configuration in the Stack
 * @resource AWS::NetworkFirewall::LoggingConfiguration
 */
class LoggingConfiguration extends core.Resource {
    constructor(scope, id, props) {
        super(scope, id, {
            physicalName: props.loggingConfigurationName,
        });
        // skip validation for late-bound values.
        if (props.firewallName && !core.Token.isUnresolved(props.firewallName)) {
            if (!/^[a-zA-Z0-9-]{1,128}$/.test(props.firewallName)) {
                // Throws and error if logGroup is invalid format.
                throw new Error(`'FirewallName' must have 1-128 characters of only letters, numbers, and hyphens. Got: ${props.firewallName}`);
            }
        }
        this.firewallRef = props.firewallRef;
        this.firewallName = props.firewallName;
        this.loggingLocations = props.loggingLocations || [];
        const logDestinationConfigs = this.iLogLocationsToLogDestinationConfigProperty(this.loggingLocations);
        const loggingConfigurationProperty = {
            logDestinationConfigs: logDestinationConfigs,
        };
        const resourceProps = {
            firewallArn: this.firewallRef,
            loggingConfiguration: loggingConfigurationProperty,
            firewallName: props.firewallName,
        };
        const resource = new aws_networkfirewall_1.CfnLoggingConfiguration(scope, `${id}`, resourceProps);
        this.firewallRef = resource.firewallArn;
    }
    /**
     * Convert ILogLocation array to L1 LogDestinationConfigProperty array.
     * @param logLocations An array of assorted Log Locations
     * @returns Array of LogDestinationConfigProperty objects.
     */
    iLogLocationsToLogDestinationConfigProperty(logLocations) {
        let logDestinationConfigs = [];
        let logLocation;
        for (logLocation of logLocations) {
            logDestinationConfigs.push({
                logDestination: logLocation.logDestination,
                logDestinationType: logLocation.logDestinationType,
                logType: logLocation.logType,
            });
        }
        return logDestinationConfigs;
    }
}
exports.LoggingConfiguration = LoggingConfiguration;
;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nZ2luZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImxvZ2dpbmcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQ0EseUVBQXdHO0FBQ3hHLCtDQUE0QztBQUM1Qyx5Q0FBeUM7QUFFekM7O0dBRUc7QUFDSCxJQUFZLE9BVVg7QUFWRCxXQUFZLE9BQU87SUFDakI7O09BRUc7SUFDSCwwQkFBZSxDQUFBO0lBRWY7O09BRUc7SUFDSCx3QkFBYSxDQUFBO0FBQ2YsQ0FBQyxFQVZXLE9BQU8sdUJBQVAsT0FBTyxRQVVsQjtBQUFBLENBQUM7QUFFRjs7R0FFRztBQUNILElBQVksa0JBZVg7QUFmRCxXQUFZLGtCQUFrQjtJQUM1Qjs7TUFFRTtJQUNGLG1EQUE2QixDQUFBO0lBRTdCOztPQUVHO0lBQ0gsaUVBQTJDLENBQUE7SUFFM0M7O09BRUc7SUFDSCwrQkFBUyxDQUFBO0FBQ1gsQ0FBQyxFQWZXLGtCQUFrQixrQ0FBbEIsa0JBQWtCLFFBZTdCO0FBQUEsQ0FBQztBQW9CRCxDQUFDO0FBVUQsQ0FBQztBQUVGOztHQUVHO0FBQ0gsTUFBc0IsZUFBZTtJQUluQyxZQUFZLGtCQUFxQyxFQUFFLEtBQXNCO1FBQ3ZFLElBQUksQ0FBQyxPQUFPLEdBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQztRQUMzQixJQUFJLENBQUMsa0JBQWtCLEdBQUcsa0JBQWtCLENBQUM7SUFDL0MsQ0FBQztDQUNGO0FBUkQsMENBUUM7QUFBQSxDQUFDO0FBaUJELENBQUM7QUFFRjs7R0FFRztBQUNILE1BQWEsYUFBYyxTQUFRLGVBQWU7SUFLaEQsWUFBWSxLQUF3QjtRQUNsQyxLQUFLLENBQUMsa0JBQWtCLENBQUMsRUFBRSxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ3BDLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxrQkFBa0IsQ0FBQyxFQUFFLENBQUM7UUFDaEQsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDO1FBRTdCLG9EQUFvRDtRQUNwRCxlQUFN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ekIsY0FBYyxFQUFFLFdBQVcsQ0FBQyxjQUFjO2dCQUMxQyxrQkFBa0IsRUFBRSxXQUFXLENBQUMsa0JBQWtCO2dCQUNsRCxPQUFPLEVBQUUsV0FBVyxDQUFDLE9BQU87YUFDN0IsQ0FBQyxDQUFDO1NBQ0o7UUFDRCxPQUFPLHFCQUFxQixDQUFDO0lBQy9CLENBQUM7Q0FDRjtBQXRFRCxvREFzRUM7QUFBQSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29uc3RydWN0IH0gZnJvbSAnY29uc3RydWN0cyc7XG5pbXBvcnQgeyBDZm5Mb2dnaW5nQ29uZmlndXJhdGlvbiwgQ2ZuTG9nZ2luZ0NvbmZpZ3VyYXRpb25Qcm9wcyB9IGZyb20gJ2F3cy1jZGstbGliL2F3cy1uZXR3b3JrZmlyZXdhbGwnO1xuaW1wb3J0IHsgQnVja2V0IH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLXMzJztcbmltcG9ydCAqIGFzIGNvcmUgZnJvbSAnYXdzLWNkay1saWIvY29yZSc7XG5cbi8qKlxuICogVGhlIHR5cGUgb2YgbG9nIHRvIHNlbmQuXG4gKi9cbmV4cG9ydCBlbnVtIExvZ1R5cGV7XG4gIC8qKlxuICAgKiBBbGVydCBsb2dzIHJlcG9ydCB0cmFmZmljIHRoYXQgbWF0Y2hlcyBhIHN0YXRlZnVsIHJ1bGUgd2l0aCBhbiBhY3Rpb24gc2V0dGluZyB0aGF0IHNlbmRzIGFuIGFsZXJ0IGxvZyBtZXNzYWdlLlxuICAgKi9cbiAgQUxFUlQgPSAnQUxFUlQnLFxuXG4gIC8qKlxuICAgKiBGbG93IGxvZ3MgYXJlIHN0YW5kYXJkIG5ldHdvcmsgdHJhZmZpYyBmbG93IGxvZ3MuXG4gICAqL1xuICBGTE9XID0gJ0ZMT1cnLFxufTtcblxuLyoqXG4gKiBUaGUgdHlwZSBvZiBzdG9yYWdlIGRlc3RpbmF0aW9uIHRvIHNlbmQgdGhlc2UgbG9ncyB0by5cbiAqL1xuZXhwb3J0IGVudW0gTG9nRGVzdGluYXRpb25UeXBlIHtcbiAgLyoqXG4gICogU3RvcmUgbG9ncyB0byBDbG91ZFdhdGNoIGxvZyBncm91cC5cbiAgKi9cbiAgQ0xPVURXQVRDSCA9ICdDbG91ZFdhdGNoTG9ncycsXG5cbiAgLyoqXG4gICAqIFN0b3JlIGxvZ3MgdG8gYSBLaW5lc2lzIERhdGEgRmlyZWhvc2UgZGVsaXZlcnkgc3RyZWFtLlxuICAgKi9cbiAgS0lORVNJU0RBVEFGSVJFSE9TRSA9ICdLaW5lc2lzRGF0YUZpcmVob3NlJyxcblxuICAvKipcbiAgICogU3RvcmUgbG9ncyB0byBhbiBTMyBidWNrZXQuXG4gICAqL1xuICBTMyA9ICdTMycsXG59O1xuXG4vKipcbiAqIERlZmluZXMgYSBMb2cgTG9jYXRpb24gaW4gdGhlIFN0YWNrLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIElMb2dMb2NhdGlvbiB7XG4gIC8qKlxuICAgKiBUaGUgdHlwZSBvZiBsb2cgdG8gc2VuZC5cbiAgICovXG4gIHJlYWRvbmx5IGxvZ1R5cGU6IExvZ1R5cGUgfCBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSB0eXBlIG9mIHN0b3JhZ2UgZGVzdGluYXRpb24gdG8gc2VuZCB0aGVzZSBsb2dzIHRvLlxuICAgKi9cbiAgcmVhZG9ubHkgbG9nRGVzdGluYXRpb25UeXBlOiBMb2dEZXN0aW5hdGlvblR5cGUgfCBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBuYW1lZCBsb2NhdGlvbiBmb3IgdGhlIGxvZ3MsIHByb3ZpZGVkIGluIGEga2V5OnZhbHVlIG1hcHBpbmcgdGhhdCBpcyBzcGVjaWZpYyB0byB0aGUgY2hvc2VuIGRlc3RpbmF0aW9uIHR5cGUuXG4gICAqL1xuICByZWFkb25seSBsb2dEZXN0aW5hdGlvbjogeyBba2V5OnN0cmluZ106IHN0cmluZyB9O1xufTtcblxuLyoqXG4gKiBCYXNlIExvZyBMb2NhdGlvbiBzdHJ1Y3R1cmUuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTG9nTG9jYXRpb25Qcm9wcyB7XG4gIC8qKlxuICAgKiBUaGUgdHlwZSBvZiBsb2cgdG8gc2VuZC5cbiAgICovXG4gIHJlYWRvbmx5IGxvZ1R5cGU6IExvZ1R5cGUgfCBzdHJpbmc7XG59O1xuXG4vKipcbiAqIEJhc2UgTG9nIExvY2F0aW9uIGNsYXNzXG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBMb2dMb2NhdGlvbkJhc2UgaW1wbGVtZW50cyBJTG9nTG9jYXRpb24ge1xuICBwdWJsaWMgcmVhZG9ubHkgbG9nVHlwZSA6IExvZ1R5cGUgfCBzdHJpbmc7XG4gIHB1YmxpYyByZWFkb25seSBsb2dEZXN0aW5hdGlvblR5cGU6IExvZ0Rlc3RpbmF0aW9uVHlwZSB8IHN0cmluZztcbiAgcHVibGljIGFic3RyYWN0IHJlYWRvbmx5IGxvZ0Rlc3RpbmF0aW9uOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9O1xuICBjb25zdHJ1Y3Rvcihsb2dEZXN0aW5hdGlvblR5cGU6TG9nRGVzdGluYXRpb25UeXBlLCBwcm9wczpMb2dMb2NhdGlvblByb3BzKSB7XG4gICAgdGhpcy5sb2dUeXBlPXByb3BzLmxvZ1R5cGU7XG4gICAgdGhpcy5sb2dEZXN0aW5hdGlvblR5cGUgPSBsb2dEZXN0aW5hdGlvblR5cGU7XG4gIH1cbn07XG5cbi8qKlxuICogRGVmaW5lcyBhIFMzIEJ1Y2tldCBMb2dnaW5nIE9wdGlvbi5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTM0xvZ0xvY2F0aW9uUHJvcHMgZXh0ZW5kcyBMb2dMb2NhdGlvblByb3Bze1xuICAvKipcbiAgICogVGhlIG5hbWUgb2YgdGhlIFMzIGJ1Y2tldCB0byBzZW5kIGxvZ3MgdG8uXG4gICAqL1xuICByZWFkb25seSBidWNrZXROYW1lOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBsb2NhdGlvbiBwcmVmaXggdG8gdXNlXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gbm8gcHJlZml4IGlzIHVzZWQuXG4gICAqL1xuICByZWFkb25seSBwcmVmaXg/OiBzdHJpbmc7XG59O1xuXG4vKipcbiAqIERlZmluZXMgYSBTMyBCdWNrZXQgTG9nZ2luZyBjb25maWd1cmF0aW9uLlxuICovXG5leHBvcnQgY2xhc3MgUzNMb2dMb2NhdGlvbiBleHRlbmRzIExvZ0xvY2F0aW9uQmFzZSB7XG4gIHB1YmxpYyByZWFkb25seSBsb2dUeXBlIDogTG9nVHlwZSB8IHN0cmluZztcbiAgcHVibGljIHJlYWRvbmx5IGxvZ0Rlc3RpbmF0aW9uVHlwZSA6IExvZ0Rlc3RpbmF0aW9uVHlwZSB8IHN0cmluZztcbiAgcHVibGljIHJlYWRvbmx5IGxvZ0Rlc3RpbmF0aW9uOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9O1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOlMzTG9nTG9jYXRpb25Qcm9wcykge1xuICAgIHN1cGVyKExvZ0Rlc3RpbmF0aW9uVHlwZS5TMywgcHJvcHMpO1xuICAgIHRoaXMubG9nRGVzdGluYXRpb25UeXBlID0gTG9nRGVzdGluYXRpb25UeXBlLlMzO1xuICAgIHRoaXMubG9nVHlwZSA9IHByb3BzLmxvZ1R5cGU7XG5cbiAgICAvLyBUaHJvd3MgYW5kIGVycm9yIGlmIGJ1Y2tldE5hbWUgaXMgaW52YWxpZCBmb3JtYXQuXG4gICAgQnVja2V0LnZhbGlkYXRlQnVja2V0TmFtZShwcm9wcy5idWNrZXROYW1lKTtcbiAgICBpZiAocHJvcHMucHJlZml4KSB7XG4gICAgICBpZiAoIS9eW2EtekEtWjAtOV8uISonKCktXXsxLH0kLy50ZXN0KHByb3BzLnByZWZpeCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAncHJlZml4JyBtdXN0IGhhdmUgb25seSBsZXR0ZXJzLCBudW1iZXJzLCBoeXBoZW5zLCBkb3RzICguKSwgdW5kZXJzY29yZXMsIHBhcmFudGhlc2VzLCBzdGFycygqKSwgYW5kIGV4cGxhaW5hdGlvbiBwb2ludHMgKCEpLiBHb3Q6ICR7cHJvcHMucHJlZml4fWApO1xuICAgICAgfVxuICAgICAgdGhpcy5sb2dEZXN0aW5hdGlvbiA9IHtcbiAgICAgICAgYnVja2V0TmFtZTogcHJvcHMuYnVja2V0TmFtZSxcbiAgICAgICAgcHJlZml4OiBwcm9wcy5wcmVmaXgsXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmxvZ0Rlc3RpbmF0aW9uID0ge1xuICAgICAgICBidWNrZXROYW1lOiBwcm9wcy5idWNrZXROYW1lLFxuICAgICAgfTtcbiAgICB9XG4gIH1cbn07XG5cbi8qKlxuICogRGVmaW5lcyBhIEtpbmVzaXMgRGVsaXZlcnkgU3RyZWFtIExvZ2dpbmcgT3B0aW9uLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIEtpbmVzaXNEYXRhRmlyZWhvc2VMb2dMb2NhdGlvblByb3BzIGV4dGVuZHMgTG9nTG9jYXRpb25Qcm9wc3tcbiAgLyoqXG4gICAqIFRoZSBuYW1lIG9mIHRoZSBLaW5lc2lzIERhdGEgRmlyZWhvc2UgZGVsaXZlcnkgc3RyZWFtIHRvIHNlbmQgbG9ncyB0by5cbiAgICovXG4gIHJlYWRvbmx5IGRlbGl2ZXJ5U3RyZWFtOiBzdHJpbmc7XG59O1xuXG4vKipcbiAqIERlZmluZXMgYSBLaW5lc2lzIERlbGl2ZXJ5IFN0cmVhbSBMb2dnaW5nIENvbmZpZ3VyYXRpb24uXG4gKi9cbmV4cG9ydCBjbGFzcyBLaW5lc2lzRGF0YUZpcmVob3NlTG9nTG9jYXRpb24gZXh0ZW5kcyBMb2dMb2NhdGlvbkJhc2Uge1xuICBwdWJsaWMgcmVhZG9ubHkgbG9nVHlwZSA6IExvZ1R5cGUgfCBzdHJpbmc7XG4gIHB1YmxpYyByZWFkb25seSBsb2dEZXN0aW5hdGlvblR5cGUgOiBMb2dEZXN0aW5hdGlvblR5cGUgfCBzdHJpbmc7XG4gIHB1YmxpYyByZWFkb25seSBsb2dEZXN0aW5hdGlvbjogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfTtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczpLaW5lc2lzRGF0YUZpcmVob3NlTG9nTG9jYXRpb25Qcm9wcykge1xuICAgIHN1cGVyKExvZ0Rlc3RpbmF0aW9uVHlwZS5LSU5FU0lTREFUQUZJUkVIT1NFLCBwcm9wcyk7XG4gICAgdGhpcy5sb2dEZXN0aW5hdGlvblR5cGUgPSBMb2dEZXN0aW5hdGlvblR5cGUuS0lORVNJU0RBVEFGSVJFSE9TRTtcbiAgICB0aGlzLmxvZ1R5cGUgPSBwcm9wcy5sb2dUeXBlO1xuXG4gICAgLy8gVGhyb3dzIGFuZCBlcnJvciBpZiBkZWxpdmVyeVN0cmVhbSBpcyBpbnZhbGlkIGZvcm1hdC5cbiAgICAvLyBza2lwIHZhbGlkYXRpb24gZm9yIGxhdGUtYm91bmQgdmFsdWVzLlxuICAgIGlmICggIWNvcmUuVG9rZW4uaXNVbnJlc29sdmVkKHByb3BzLmRlbGl2ZXJ5U3RyZWFtKSkge1xuICAgICAgaWYgKCEvXlthLXpBLVowLTlfLi1dezEsNjR9JC8udGVzdChwcm9wcy5kZWxpdmVyeVN0cmVhbSkpIHtcbiAgICAgICAgLy8gVGhyb3dzIGFuZCBlcnJvciBpZiBsb2dHcm91cCBpcyBpbnZhbGlkIGZvcm1hdC5cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAnTG9nR3JvdXAnIG11c3QgaGF2ZSAxLTY0IGNoYXJhY3RlcnMgb2Ygb25seSBsZXR0ZXJzLCBudW1iZXJzLCBoeXBoZW5zLCBkb3RzICguKSwgYW5kIHVuZGVyc2NvcmVzLiBHb3Q6ICR7cHJvcHMuZGVsaXZlcnlTdHJlYW19YCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5sb2dEZXN0aW5hdGlvbiA9IHtcbiAgICAgIGRlbGl2ZXJ5U3RyZWFtOiBwcm9wcy5kZWxpdmVyeVN0cmVhbSxcbiAgICB9O1xuICB9XG59O1xuXG4vKipcbiAqIERlZmluZXMgYSBDbG91ZCBXYXRjaCBMb2cgR3JvdXAgTG9nZ2luZyBPcHRpb24uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ2xvdWRXYXRjaExvZ0xvY2F0aW9uUHJvcHMgZXh0ZW5kcyBMb2dMb2NhdGlvblByb3Bze1xuICAvKipcbiAgICogVGhlIG5hbWUgb2YgdGhlIENsb3VkV2F0Y2ggTG9nIEdyb3VwIHRvIHNlbmQgbG9ncyB0by5cbiAgICovXG4gIHJlYWRvbmx5IGxvZ0dyb3VwOiBzdHJpbmc7XG59O1xuXG4vKipcbiAqIERlZmluZXMgYSBDbG91ZCBXYXRjaCBMb2cgR3JvdXAgTG9nZ2luZyBDb25maWd1cmF0aW9uLlxuICovXG5leHBvcnQgY2xhc3MgQ2xvdWRXYXRjaExvZ0xvY2F0aW9uIGV4dGVuZHMgTG9nTG9jYXRpb25CYXNlIHtcbiAgcHVibGljIHJlYWRvbmx5IGxvZ1R5cGUgOiBMb2dUeXBlIHwgc3RyaW5nO1xuICBwdWJsaWMgcmVhZG9ubHkgbG9nRGVzdGluYXRpb25UeXBlIDogTG9nRGVzdGluYXRpb25UeXBlIHwgc3RyaW5nO1xuICBwdWJsaWMgcmVhZG9ubHkgbG9nRGVzdGluYXRpb246IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH07XG5cbiAgY29uc3RydWN0b3IocHJvcHM6Q2xvdWRXYXRjaExvZ0xvY2F0aW9uUHJvcHMpIHtcbiAgICBzdXBlcihMb2dEZXN0aW5hdGlvblR5cGUuQ0xPVURXQVRDSCwgcHJvcHMpO1xuICAgIHRoaXMubG9nRGVzdGluYXRpb25UeXBlID0gTG9nRGVzdGluYXRpb25UeXBlLkNMT1VEV0FUQ0g7XG4gICAgdGhpcy5sb2dUeXBlID0gcHJvcHMubG9nVHlwZTtcblxuICAgIC8vIHNraXAgdmFsaWRhdGlvbiBmb3IgbGF0ZS1ib3VuZCB2YWx1ZXMuXG4gICAgaWYgKCAhY29yZS5Ub2tlbi5pc1VucmVzb2x2ZWQocHJvcHMubG9nR3JvdXApKSB7XG4gICAgICBpZiAoIS9eW2EtekEtWi1fMC05Ly4jXXsxLDUxMn0kLy50ZXN0KHByb3BzLmxvZ0dyb3VwKSkge1xuICAgICAgICAvLyBUaHJvd3MgYW5kIGVycm9yIGlmIGxvZ0dyb3VwIGlzIGludmFsaWQgZm9ybWF0LlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCdMb2dHcm91cCcgbXVzdCBoYXZlIDEtNTEyIGNoYXJhY3RlcnMgb2Ygb25seSBsZXR0ZXJzLCBudW1iZXJzLCBoeXBoZW5zLCB1bmRlcnNjb3JlcywgYW5kIHBvdW5kcyAoIykuIEdvdDogJHtwcm9wcy5sb2dHcm91cH0gYCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5sb2dEZXN0aW5hdGlvbiA9IHtcbiAgICAgIGxvZ0dyb3VwOiBwcm9wcy5sb2dHcm91cCxcbiAgICB9O1xuICB9XG59O1xuXG4vKipcbiAgKiBEZWZpbmVzIGEgTmV0d29yayBGaXJld2FsbCBMb2dnaW5nIENvbmZpZ3VyYXRpb24gaW4gdGhlIHN0YWNrXG4gICovXG5leHBvcnQgaW50ZXJmYWNlIElMb2dnaW5nQ29uZmlndXJhdGlvbiBleHRlbmRzIGNvcmUuSVJlc291cmNle1xuICAvKipcbiAgICogVGhlIEFtYXpvbiBSZXNvdXJjZSBOYW1lIChBUk4pIG9mIHRoZSBGaXJld2FsbCB0aGF0IHRoZSBsb2dnaW5nIGNvbmZpZ3VyYXRpb24gaXMgYXNzb2NpYXRlZCB3aXRoLlxuICAgKiBZb3UgY2FuJ3QgY2hhbmdlIHRoZSBmaXJld2FsbCBzcGVjaWZpY2F0aW9uIGFmdGVyIHlvdSBjcmVhdGUgdGhlIGxvZ2dpbmcgY29uZmlndXJhdGlvbi5cbiAgICpcbiAgICogQGF0dHJpYnV0ZVxuICAgKi9cbiAgcmVhZG9ubHkgZmlyZXdhbGxSZWY6IHN0cmluZztcbn07XG5cbi8qKlxuICogVGhlIFByb3BlcnRpZXMgZm9yIGRlZmluaW5nIGEgTG9nZ2luZyBDb25maWd1cmF0aW9uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTG9nZ2luZ0NvbmZpZ3VyYXRpb25Qcm9wcyB7XG4gIC8qKlxuICAgKiBUaGUgcGh5c2ljYWwgbmFtZSBvZiB0aGlzIGxvZ2dpbmcgY29uZmlndXJhdGlvblxuICAgKlxuICAgKiBAZGVmYXVsdCAtIENsb3VkRm9ybWF0aW9uLWdlbmVyYXRlZCBuYW1lXG4gICAqL1xuICByZWFkb25seSBsb2dnaW5nQ29uZmlndXJhdGlvbk5hbWU/OiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgQW1hem9uIFJlc291cmNlIE5hbWUgKEFSTikgb2YgdGhlIEZpcmV3YWxsIHRoYXQgdGhlIGxvZ2dpbmcgY29uZmlndXJhdGlvbiBpcyBhc3NvY2lhdGVkIHdpdGguXG4gICAqIFlvdSBjYW4ndCBjaGFuZ2UgdGhlIGZpcmV3YWxsIHNwZWNpZmljYXRpb24gYWZ0ZXIgeW91IGNyZWF0ZSB0aGUgbG9nZ2luZyBjb25maWd1cmF0aW9uLlxuICAgKi9cbiAgcmVhZG9ubHkgZmlyZXdhbGxSZWY6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIG5hbWUgb2YgdGhlIGZpcmV3YWxsIHRoYXQgdGhlIGxvZ2dpbmcgY29uZmlndXJhdGlvbiBpcyBhc3NvY2lhdGVkIHdpdGguXG4gICAqIFlvdSBjYW4ndCBjaGFuZ2UgdGhlIGZpcmV3YWxsIHNwZWNpZmljYXRpb24gYWZ0ZXIgeW91IGNyZWF0ZSB0aGUgbG9nZ2luZyBjb25maWd1cmF0aW9uLlxuICAgKlxuICAgKiBAZGVmYXVsdCAtIE5vIGZpcmV3YWxsIG5hbWUgaXMgbG9nZ2VkLlxuICAgKi9cbiAgcmVhZG9ubHkgZmlyZXdhbGxOYW1lPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBEZWZpbmVzIGhvdyBBV1MgTmV0d29yayBGaXJld2FsbCBwZXJmb3JtcyBsb2dnaW5nIGZvciBhIEZpcmV3YWxsLlxuICAgKlxuICAgKiBAZGVmYXVsdCAtIE5vIGxvZ2dpbmcgbG9jYXRpb25zIGFyZSBjb25maWd1cmVkLCBubyBsb2dzIHdpbGwgYmUgc2VudC5cbiAgICovXG4gIHJlYWRvbmx5IGxvZ2dpbmdMb2NhdGlvbnM/OiBJTG9nTG9jYXRpb25bXTtcbn07XG5cbi8qKlxuICogRGVmaW5lcyBhIExvZ2dpbmcgQ29uZmlndXJhdGlvbiBpbiB0aGUgU3RhY2tcbiAqIEByZXNvdXJjZSBBV1M6Ok5ldHdvcmtGaXJld2FsbDo6TG9nZ2luZ0NvbmZpZ3VyYXRpb25cbiAqL1xuZXhwb3J0IGNsYXNzIExvZ2dpbmdDb25maWd1cmF0aW9uIGV4dGVuZHMgY29yZS5SZXNvdXJjZSBpbXBsZW1lbnRzIElMb2dnaW5nQ29uZmlndXJhdGlvbiB7XG5cbiAgLyoqXG4gICAqIFRoZSBhc3NvY2lhdGVkIGZpcmV3YWxsIEFyblxuICAgKiBAYXR0cmlidXRlXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgZmlyZXdhbGxSZWY6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIGFzc29jaWF0ZWQgZmlyZXdhbGwgTmFtZVxuICAgKiBAYXR0cmlidXRlXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgZmlyZXdhbGxOYW1lPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBEZWZpbmVzIGhvdyBBV1MgTmV0d29yayBGaXJld2FsbCBwZXJmb3JtcyBsb2dnaW5nIGZvciBhIEZpcmV3YWxsLlxuICAgKlxuICAgKi9cbiAgcHVibGljIGxvZ2dpbmdMb2NhdGlvbnM6IElMb2dMb2NhdGlvbltdO1xuXG4gIGNvbnN0cnVjdG9yKHNjb3BlOkNvbnN0cnVjdCwgaWQ6IHN0cmluZywgcHJvcHM6IExvZ2dpbmdDb25maWd1cmF0aW9uUHJvcHMpIHtcbiAgICBzdXBlcihzY29wZSwgaWQsIHtcbiAgICAgIHBoeXNpY2FsTmFtZTogcHJvcHMubG9nZ2luZ0NvbmZpZ3VyYXRpb25OYW1lLFxuICAgIH0pO1xuXG4gICAgLy8gc2tpcCB2YWxpZGF0aW9uIGZvciBsYXRlLWJvdW5kIHZhbHVlcy5cbiAgICBpZiAocHJvcHMuZmlyZXdhbGxOYW1lICYmICFjb3JlLlRva2VuLmlzVW5yZXNvbHZlZChwcm9wcy5maXJld2FsbE5hbWUpKSB7XG4gICAgICBpZiAoIS9eW2EtekEtWjAtOS1dezEsMTI4fSQvLnRlc3QocHJvcHMuZmlyZXdhbGxOYW1lKSkge1xuICAgICAgICAvLyBUaHJvd3MgYW5kIGVycm9yIGlmIGxvZ0dyb3VwIGlzIGludmFsaWQgZm9ybWF0LlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCdGaXJld2FsbE5hbWUnIG11c3QgaGF2ZSAxLTEyOCBjaGFyYWN0ZXJzIG9mIG9ubHkgbGV0dGVycywgbnVtYmVycywgYW5kIGh5cGhlbnMuIEdvdDogJHtwcm9wcy5maXJld2FsbE5hbWV9YCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5maXJld2FsbFJlZiA9IHByb3BzLmZpcmV3YWxsUmVmO1xuICAgIHRoaXMuZmlyZXdhbGxOYW1lID0gcHJvcHMuZmlyZXdhbGxOYW1lO1xuICAgIHRoaXMubG9nZ2luZ0xvY2F0aW9ucyA9IHByb3BzLmxvZ2dpbmdMb2NhdGlvbnMgfHwgW107XG5cbiAgICBjb25zdCBsb2dEZXN0aW5hdGlvbkNvbmZpZ3M6Q2ZuTG9nZ2luZ0NvbmZpZ3VyYXRpb24uTG9nRGVzdGluYXRpb25Db25maWdQcm9wZXJ0eVtdID1cbiAgICB0aGlzLmlMb2dMb2NhdGlvbnNUb0xvZ0Rlc3RpbmF0aW9uQ29uZmlnUHJvcGVydHkodGhpcy5sb2dnaW5nTG9jYXRpb25zKTtcblxuICAgIGNvbnN0IGxvZ2dpbmdDb25maWd1cmF0aW9uUHJvcGVydHk6Q2ZuTG9nZ2luZ0NvbmZpZ3VyYXRpb24uTG9nZ2luZ0NvbmZpZ3VyYXRpb25Qcm9wZXJ0eSA9IHtcbiAgICAgIGxvZ0Rlc3RpbmF0aW9uQ29uZmlnczogbG9nRGVzdGluYXRpb25Db25maWdzLFxuICAgIH07XG4gICAgY29uc3QgcmVzb3VyY2VQcm9wczpDZm5Mb2dnaW5nQ29uZmlndXJhdGlvblByb3BzID0ge1xuICAgICAgZmlyZXdhbGxBcm46IHRoaXMuZmlyZXdhbGxSZWYsXG4gICAgICBsb2dnaW5nQ29uZmlndXJhdGlvbjogbG9nZ2luZ0NvbmZpZ3VyYXRpb25Qcm9wZXJ0eSxcbiAgICAgIGZpcmV3YWxsTmFtZTogcHJvcHMuZmlyZXdhbGxOYW1lLFxuICAgIH07XG4gICAgY29uc3QgcmVzb3VyY2U6Q2ZuTG9nZ2luZ0NvbmZpZ3VyYXRpb24gPSBuZXcgQ2ZuTG9nZ2luZ0NvbmZpZ3VyYXRpb24oc2NvcGUsIGAke2lkfWAsIHJlc291cmNlUHJvcHMpO1xuXG4gICAgdGhpcy5maXJld2FsbFJlZiA9IHJlc291cmNlLmZpcmV3YWxsQXJuO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgSUxvZ0xvY2F0aW9uIGFycmF5IHRvIEwxIExvZ0Rlc3RpbmF0aW9uQ29uZmlnUHJvcGVydHkgYXJyYXkuXG4gICAqIEBwYXJhbSBsb2dMb2NhdGlvbnMgQW4gYXJyYXkgb2YgYXNzb3J0ZWQgTG9nIExvY2F0aW9uc1xuICAgKiBAcmV0dXJucyBBcnJheSBvZiBMb2dEZXN0aW5hdGlvbkNvbmZpZ1Byb3BlcnR5IG9iamVjdHMuXG4gICAqL1xuICBwdWJsaWMgaUxvZ0xvY2F0aW9uc1RvTG9nRGVzdGluYXRpb25Db25maWdQcm9wZXJ0eShsb2dMb2NhdGlvbnM6SUxvZ0xvY2F0aW9uW10pOkNmbkxvZ2dpbmdDb25maWd1cmF0aW9uLkxvZ0Rlc3RpbmF0aW9uQ29uZmlnUHJvcGVydHlbXSB7XG4gICAgbGV0IGxvZ0Rlc3RpbmF0aW9uQ29uZmlnczpDZm5Mb2dnaW5nQ29uZmlndXJhdGlvbi5Mb2dEZXN0aW5hdGlvbkNvbmZpZ1Byb3BlcnR5W10gPSBbXTtcbiAgICBsZXQgbG9nTG9jYXRpb246SUxvZ0xvY2F0aW9uO1xuICAgIGZvciAobG9nTG9jYXRpb24gb2YgbG9nTG9jYXRpb25zKSB7XG4gICAgICBsb2dEZXN0aW5hdGlvbkNvbmZpZ3MucHVzaCh7XG4gICAgICAgIGxvZ0Rlc3RpbmF0aW9uOiBsb2dMb2NhdGlvbi5sb2dEZXN0aW5hdGlvbixcbiAgICAgICAgbG9nRGVzdGluYXRpb25UeXBlOiBsb2dMb2NhdGlvbi5sb2dEZXN0aW5hdGlvblR5cGUsXG4gICAgICAgIGxvZ1R5cGU6IGxvZ0xvY2F0aW9uLmxvZ1R5cGUsXG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGxvZ0Rlc3RpbmF0aW9uQ29uZmlncztcbiAgfVxufTtcbiJdfQ==